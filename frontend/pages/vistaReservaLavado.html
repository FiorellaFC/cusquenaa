<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reservas - Lubricentro La Cusque√±a</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- AOS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f2f2f2;
            color: #333;
        }

        .aviso {
            background-color: #212529;
            color: #f8f9fa;
            padding: 50px 30px;
            border-radius: 8px;
            margin-top: 40px;
            text-align: center;
        }

        .encabezado {
            text-align: center;
            padding: 60px 20px;
        }
frontend/pages/vistaReservaLavado.html
        .breadcrumb-custom {
            text-align: center;
            margin-top: 10px;
            color: #6c757d;
        }

        .estilo-elegante {
            max-width: 900px;
            margin: 40px auto;
            text-align: center;
        }

        .btn-horario {
            border: 2px solid #198754;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: 600;
            background: white;
            transition: 0.2s;
        }

        .btn-horario:hover,
        .btn-horario.active {
            background: #198754;
            color: white;
        }

        .resumen-cita .card-header {
            background: #000;
            color: #d4af37;
            border-bottom: 2px solid #d4af37;
        }

        footer {
            background: #212529;
            color: white;
            text-align: center;
            padding: 30px 0;
            margin-top: 80px;
        }

        /* CHECK MODAL */
        .checkmark-circle {
            width: 90px;
            height: 90px;
            position: relative;
            display: inline-block;
        }

        .checkmark-circle .background {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: #4caf50;
            position: absolute;
            top: 0;
            left: 0;
        }

        .checkmark {
            width: 45px;
            height: 25px;
            border-left: 5px solid #fff;
            border-bottom: 5px solid #fff;
            transform: rotate(-45deg);
            position: absolute;
            top: 28px;
            left: 22px;
            opacity: 0;
            animation: draw 0.6s ease forwards;
        }

        @keyframes draw {
            0% {
                opacity: 0;
                transform: scale(0) rotate(-45deg);
            }

            80% {
                opacity: 1;
                transform: scale(1.2) rotate(-45deg);
            }

            100% {
                transform: scale(1) rotate(-45deg);
            }
        }
    </style>
</head>

<body>

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold" href="vistaCusquena.html">Lubricentro La Cusque√±a</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="vistaCusquena.html">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="vistaServicios.html">Servicios</a></li>
                    <li class="nav-item"><a class="nav-link" href="vistaPromociones.html">Promociones</a></li>
                    <li class="nav-item"><a class="nav-link" href="vistaContacto.html">Contacto</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- AVISO -->
    <div class="container">
        <div class="aviso" data-aos="fade-up">
            <p>Estimados clientes, nuestro horario de atenci√≥n es de:</p>
            <p><strong>Lunes a S√°bados: 8:00 a.m. a 6:00 p.m.</strong></p>
            <p><strong>Domingos: 8:00 a.m. a 1:00 p.m.</strong></p>
            <br>
            <p>Recuerda que contamos con un tiempo de tolerancia de 10 minutos.</p>
        </div>
    </div>

    <!-- ENCABEZADO -->
    <div class="encabezado" data-aos="fade-up">
        <h1>LUBRICENTRO LA CUSQUE√ëA</h1>
        <div class="breadcrumb-custom">
            HOME / RESERVAS
        </div>
    </div>

    <!-- SECCI√ìN RESERVA -->
    <div class="container mt-5">
        <h3 class="fw-bold mb-3"><i class="bi bi-calendar3"></i> Selecciona un d√≠a y un horario</h3>

        <!-- Fecha -->
        <div class="mb-4">
            <label class="form-label fw-bold">Elige una fecha:</label>
            <input type="date" id="fecha" class="form-control" min="">
        </div>

        <!-- Horarios -->
        <div id="contenedorHorarios" style="display:none;">
            <h5 class="fw-bold mb-3">Horarios disponibles</h5>
            <div class="d-flex flex-wrap gap-3" id="listaHorarios"></div>
        </div>
    </div>

    <!-- RESUMEN -->
    <div class="container mt-5" id="seccionResumen" style="display:none;">
        <div class="card resumen-cita shadow">
            <div class="card-header text-center fw-bold fs-5">Resumen de su cita</div>

            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <p class="text-muted mb-1">D√≠a seleccionado</p>
                        <p class="fw-bold fs-5" id="resumenDia"></p>
                    </div>
                    <div class="col-md-6">
                        <p class="text-muted mb-1">Hora seleccionada</p>
                        <p class="fw-bold fs-5" id="resumenHora"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- FORMULARIO -->
        <div class="card mt-4 shadow">
            <div class="card-header text-center fw-bold" style="background:black; color:#d4af37;">Complete sus datos</div>

            <div class="card-body">

                <!-- üîª AGREGADO: id="formReserva" -->
                <form id="formReserva" action="../../backend/api/controllers/agregar_reserva.php" method="POST">

                    <input type="hidden" id="inputFecha" name="fecha">
                    <input type="hidden" id="inputHora" name="hora">

                    <div class="mb-3">
                        <label class="form-label fw-bold">Nombre completo</label>
                        <input type="text" name="nombre_cliente" class="form-control" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-bold">Tel√©fono</label>
                        <input type="text" name="telefono_cliente" class="form-control" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-bold">Correo electr√≥nico</label>
                        <input type="email" name="email_cliente" class="form-control" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-bold">Tipo de lavado</label>
                        <select name="servicio_solicitado" class="form-select" required>
                            <option value="">Seleccione un tipo</option>
                            <option value="Lavado B√°sico">Lavado B√°sico</option>
                            <option value="Lavado Completo">Lavado Completo</option>
                            <option value="Lavado Premium">Lavado Premium</option>
                        </select>
                    </div>


                    <div class="text-center mt-4">
                        <button type="submit" class="btn btn-dark px-4 py-2" style="border:2px solid gold;">
                            Confirmar mi reserva
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer>
        ¬© 2025 Lubricentro La Cusque√±a ‚Äî Todos los derechos reservados
    </footer>

    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script>
        AOS.init();

        // FECHA M√çNIMA
        let hoy = new Date().toISOString().split("T")[0];
        document.getElementById("fecha").min = hoy;

        // GENERAR HORARIOS
        document.getElementById("fecha").addEventListener("change", function () {
            let fecha = new Date(this.value);
            let dia = fecha.getDay();

            let horarios = [];
            let inicio = 8;
            let fin = (dia === 0) ? 11 : 16;

            for (let h = inicio; h <= fin; h++) {
                let hora = (h < 10 ? "0" + h : h) + ":00";
                horarios.push(hora);
            }

            let lista = document.getElementById("listaHorarios");
            lista.innerHTML = "";

            horarios.forEach(h => {
                lista.innerHTML += `
                    <button class="btn-horario" onclick="seleccionarHora('${fecha.toISOString().split('T')[0]}','${h}', event)">
                        ${h}
                    </button>`;
            });

            document.getElementById("contenedorHorarios").style.display = "block";
        });

        // SELECCIONAR HORA
        function seleccionarHora(dia, hora, e) {
            document.getElementById("resumenDia").innerText = dia;
            document.getElementById("resumenHora").innerText = hora;

            document.getElementById("inputFecha").value = dia;
            document.getElementById("inputHora").value = hora;

            document.querySelectorAll(".btn-horario").forEach(btn => btn.classList.remove("active"));
            e.target.classList.add("active");

            document.getElementById("seccionResumen").style.display = "block";
        }

        /* 
        =============================================================
        ‚úî NUEVA L√ìGICA ‚Äî Mostrar el modal antes de enviar el formulario
        =============================================================
        */
        const form = document.getElementById("formReserva");

        form.addEventListener("submit", function (e) {
            e.preventDefault(); // Evitar env√≠o inmediato

            var modal = new bootstrap.Modal(document.getElementById("confirmModal"));
            modal.show();

            document.getElementById("btnModalAceptar").onclick = function () {
                modal.hide();
                form.submit(); // Env√≠o REAL
            };
        });
    </script>

    <!-- MODAL -->
    <div class="modal fade" id="confirmModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center p-4">

                <div class="checkmark-circle">
                    <div class="background"></div>
                    <div class="checkmark"></div>
                </div>

                <h3 class="mt-3">¬°Registro confirmado!</h3>
                <p>Tu servicio fue registrado correctamente.</p>

                <!-- üîª AGREGADO: id="btnModalAceptar" -->
                <button id="btnModalAceptar" class="btn btn-primary mt-3">Aceptar</button>
            </div>
        </div>
    </div>

</body>

</html>
